<!DOCTYPE html>
<html lang="en-US" data-random-animation="true" data-animation="animate-0">
  <!-- Mirrored from cosmos-themes.online/themes/watson/my-current-workspace/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 23 Nov 2021 07:42:25 GMT -->
  <!-- Added by HTTrack -->
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <!-- /Added by HTTrack -->
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="profile" href="https://gmpg.org/xfn/11">
    <link media="all" href="../wp-content/cache/autoptimize/css/autoptimize_4a3a25c402079694a1e90497bce44892.css" rel="stylesheet" />
    <title>DUSAN DIVAC &#8211; Blogs</title>
    <meta name='robots' content='max-image-preview:large' />
    <link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
    <link rel='dns-prefetch' href='http://s.w.org/' />
    <link rel="alternate" type="application/rss+xml" title="Watson &raquo; Feed" href="../feed/index.html" />
    <link rel="alternate" type="application/rss+xml" title="Watson &raquo; Comments Feed" href="../comments/feed/index.html" />
    <link rel="alternate" type="application/rss+xml" title="Watson &raquo; My Current Workspace Comments Feed" href="feed/index.html" />
    <script type="text/javascript">
      window._wpemojiSettings = {
        "baseUrl": "https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/",
        "ext": ".png",
        "svgUrl": "https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/",
        "svgExt": ".svg",
        "source": {
          "concatemoji": "https:\/\/cosmos-themes.online\/themes\/watson\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.2"
        }
      };
      ! function(e, a, t) {
        var n, r, o, i = a.createElement("canvas"),
          p = i.getContext && i.getContext("2d");

        function s(e, t) {
          var a = String.fromCharCode;
          p.clearRect(0, 0, i.width, i.height), p.fillText(a.apply(this, e), 0, 0);
          e = i.toDataURL();
          return p.clearRect(0, 0, i.width, i.height), p.fillText(a.apply(this, t), 0, 0), e === i.toDataURL()
        }

        function c(e) {
          var t = a.createElement("script");
          t.src = e, t.defer = t.type = "text/javascript", a.getElementsByTagName("head")[0].appendChild(t)
        }
        for (o = Array("flag", "emoji"), t.supports = {
            everything: !0,
            everythingExceptFlag: !0
          }, r = 0; r < o.length; r++) t.supports[o[r]] = function(e) {
          if (!p || !p.fillText) return !1;
          switch (p.textBaseline = "top", p.font = "600 32px Arial", e) {
            case "flag":
              return s([127987, 65039, 8205, 9895, 65039], [127987, 65039, 8203, 9895, 65039]) ? !1 : !s([55356, 56826, 55356, 56819], [55356, 56826, 8203, 55356, 56819]) && !s([55356, 57332, 56128, 56423, 56128, 56418, 56128, 56421, 56128, 56430, 56128, 56423, 56128, 56447], [55356, 57332, 8203, 56128, 56423, 8203, 56128, 56418, 8203, 56128, 56421, 8203, 56128, 56430, 8203, 56128, 56423, 8203, 56128, 56447]);
            case "emoji":
              return !s([10084, 65039, 8205, 55357, 56613], [10084, 65039, 8203, 55357, 56613])
          }
          return !1
        }(o[r]), t.supports.everything = t.supports.everything && t.supports[o[r]], "flag" !== o[r] && (t.supports.everythingExceptFlag = t.supports.everythingExceptFlag && t.supports[o[r]]);
        t.supports.everythingExceptFlag = t.supports.everythingExceptFlag && !t.supports.flag, t.DOMReady = !1, t.readyCallback = function() {
          t.DOMReady = !0
        }, t.supports.everything || (n = function() {
          t.readyCallback()
        }, a.addEventListener ? (a.addEventListener("DOMContentLoaded", n, !1), e.addEventListener("load", n, !1)) : (e.attachEvent("onload", n), a.attachEvent("onreadystatechange", function() {
          "complete" === a.readyState && t.readyCallback()
        })), (n = t.source || {}).concatemoji ? c(n.concatemoji) : n.wpemoji && n.twemoji && (c(n.twemoji), c(n.wpemoji)))
      }(window, document, window._wpemojiSettings);
    </script>
    <link rel='stylesheet' id='watson-heading-font-css' href='http://fonts.googleapis.com/css2?family=Playfair+Display%3Aital%2Cwght%400%2C400%3B0%2C500%3B0%2C600%3B0%2C700%3B0%2C800%3B0%2C900%3B1%2C400%3B1%2C500%3B1%2C600%3B1%2C700%3B1%2C800%3B1%2C900&amp;ver=1.0.0' type='text/css' media='all' />
    <link rel='stylesheet' id='watson-body-font-css' href='http://fonts.googleapis.com/css2?family=Roboto%3Aital%2Cwght%400%2C300%3B0%2C400%3B0%2C500%3B0%2C700%3B0%2C900%3B1%2C300%3B1%2C400%3B1%2C500%3B1%2C700%3B1%2C900&amp;ver=1.0.0' type='text/css' media='all' />
    <script type='text/javascript' src='../wp-includes/js/jquery/jquery.minaf6c.js?ver=3.6.0' id='jquery-core-js'></script>
    <link rel="https://api.w.org/" href="../wp-json/index.html" />
    <link rel="alternate" type="application/json" href="../wp-json/wp/v2/posts/118.json" />
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" />
    <meta name="generator" content="WordPress 5.8.2" />
    <link rel="canonical" href="index.html" />
    <link rel='shortlink' href='../indexdb4e.html?p=118' />
    <link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embedb294.json?url=https%3A%2F%2Fcosmos-themes.online%2Fthemes%2Fwatson%2Fmy-current-workspace%2F" />
    <link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed8d5c?url=https%3A%2F%2Fcosmos-themes.online%2Fthemes%2Fwatson%2Fmy-current-workspace%2F&amp;format=xml" />
    <link rel="icon" href="../wp-content/uploads/2021/05/cropped-watson-sicon-32x32.png" sizes="32x32" />
    <link rel="icon" href="../wp-content/uploads/2021/05/cropped-watson-sicon-192x192.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="../wp-content/uploads/2021/05/cropped-watson-sicon-180x180.png" />
    <meta name="msapplication-TileImage" content="https://cosmos-themes.online/themes/watson/wp-content/uploads/2021/05/cropped-watson-sicon-270x270.png" />
  </head>
  <body class="post-template-default single single-post postid-118 single-format-standard wp-embed-responsive elementor-default elementor-kit-8">
    <div class="preloader">
      <div class="loader">
        <h4>DUSAN DIVAC</h4>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
    <div id="page">
      <header>
        <div class="header-content">
          <div class="header-mobile">
            <h2>DUSAN DIVAC</h2>
          </div>
          <div class="header-main">
            <a class="header-toggle">
              <i class="menu-open fas fa-bars"></i>
              <i class="menu-close fas fa-times"></i>
            </a>
            <div class="header-main-inner" data-simplebar>
              <div class="nav-container">
                <div class="image-container">
                  <h2 class="header-name">DUSAN DIVAC</h2>
                  <img src="../wp-content/uploads/2021/05/profile-img.jpg" alt="Profile Image">
                </div>
                <nav id="primary-menu" class="nav-menu slide-menu">
                  <ul id="menu-main-menu" class="menu">
                    <li data-id="menu-item-54" class=" menu-item menu-item-type-post_type menu-item-object-page menu-item-home has-menu-icon">
                      <a href="https://cosmos-themes.online/themes/watson#home" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-home'></i>
                        </span>Home </a>
                    </li>
                    <li data-id="menu-item-57" class=" menu-item menu-item-type-post_type menu-item-object-page has-menu-icon">
                      <a href="../../../../index.html#about" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-user'></i>
                        </span>About Me </a>
                    </li>
                    <li data-id="menu-item-55" class=" menu-item menu-item-type-post_type menu-item-object-page has-menu-icon">
                      <a href="../../../../index.html#resume" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-license'></i>
                        </span>Resume </a>
                    </li>
                    <li data-id="menu-item-88" class=" menu-item menu-item-type-post_type menu-item-object-page has-menu-icon">
                      <a href="../../../../index.html#portfolio" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-briefcase'></i>
                        </span>Portfolio </a>
                    </li>
                    <li data-id="menu-item-89" class=" menu-item menu-item-type-post_type menu-item-object-page has-menu-icon">
                      <a href="../../../../index.html#blog" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-book'></i>
                        </span>Blog </a>
                    </li>
                    <li data-id="menu-item-70" class=" menu-item menu-item-type-post_type menu-item-object-page has-menu-icon">
                      <a href="../../../../index.html#contact" class="no-scroll">
                        <span class='nav-menu-icon'>
                          <i class='lnr lnr-envelope'></i>
                        </span>Contact </a>
                    </li>
                  </ul>
                </nav>
                <div class="nav-footer">
                  <ul class="social">
                    <li>
                      <a href="#">
                        <i class="fab fa-facebook-square"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fab fa-twitter-square"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fab fa-youtube-square"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fab fa-dribbble-square"></i>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fab fa-behance-square"></i>
                      </a>
                    </li>
                  </ul>
                  <div class="copy">
                    <p>2021 Â© Cosmos-Themes. <br>All Right Reserved. </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>
      <div id="sidebar">
        <div class="sidebar-button">
          <span class="icon">
            <i class="fa fa-arrow-left"></i>
          </span>
        </div>
        <div class="sidebar-content">
          <div class="sidebar-content-wrapper">
            <div id="search-2" class="watson-single-widget widget_meta widget_search">
              <form class="search-form" role="search" method="get" action="https://cosmos-themes.online/themes/watson/">
                <label>
                  <span class="screen-reader-text">Search for:</span>
                  <input type="search" class="search-field" placeholder="Search..." value="" name="s">
                </label>
                <input type="submit" class="search-submit" value="Search">
              </form>
            </div>
            <div id="recent-posts-2" class="watson-single-widget widget_meta widget_recent_entries">
              <h4 class="widget-title">Recent Posts</h4>
              <ul>
                <li>
                  <a href="../best-way-to-design/index.html">Best Way To Design</a>
                </li>
                <li>
                  <a href="../things-i-need-to-get-started/index.html">Things I Need To Get Started</a>
                </li>
                <li>
                  <a href="index.html" aria-current="page">My Current Workspace</a>
                </li>
                <li>
                  <a href="../best-place-to-travel-this-summer/index.html">Best Place To Travel This Summer</a>
                </li>
                <li>
                  <a href="../latest-ui-trends-to-inspired-from/index.html">Latest UI Trends To Inspired From</a>
                </li>
              </ul>
            </div>
            <div id="categories-3" class="watson-single-widget widget_meta widget_categories">
              <h4 class="widget-title">Categories</h4>
              <ul>
                <li class="cat-item cat-item-8">
                  <a href="../category/design/index.html">Design</a>
                </li>
                <li class="cat-item cat-item-6">
                  <a href="../category/lifestyle/index.html">Lifestyle</a>
                </li>
                <li class="cat-item cat-item-9">
                  <a href="../category/personal/index.html">Personal</a>
                </li>
                <li class="cat-item cat-item-5">
                  <a href="../category/technology/index.html">Technology</a>
                </li>
                <li class="cat-item cat-item-4">
                  <a href="../category/traveling/index.html">Traveling</a>
                </li>
                <li class="cat-item cat-item-7">
                  <a href="../category/web-design/index.html">Web Design</a>
                </li>
              </ul>
            </div>
            <div id="recent-comments-2" class="watson-single-widget widget_meta widget_recent_comments">
              <h4 class="widget-title">Recent Comments</h4>
              <ul id="recentcomments">
                <li class="recentcomments">
                  <span class="comment-author-link">Watson Admin</span> on <a href="../best-way-to-design/index.html#comment-6">Best Way To Design</a>
                </li>
                <li class="recentcomments">
                  <span class="comment-author-link">Terry K. Gaitan</span> on <a href="../best-way-to-design/index.html#comment-5">Best Way To Design</a>
                </li>
                <li class="recentcomments">
                  <span class="comment-author-link">Rebecca R. Smith</span> on <a href="../best-way-to-design/index.html#comment-4">Best Way To Design</a>
                </li>
                <li class="recentcomments">
                  <span class="comment-author-link">Randy E. Oleary</span> on <a href="../best-way-to-design/index.html#comment-3">Best Way To Design</a>
                </li>
                <li class="recentcomments">
                  <span class="comment-author-link">John Doe</span> on <a href="../best-way-to-design/index.html#comment-2">Best Way To Design</a>
                </li>
              </ul>
            </div>
            <div id="meta-3" class="watson-single-widget widget_meta widget_meta">
              <h4 class="widget-title">Meta</h4>
              <ul>
                <li>
                  <a href="../wp-login.html">Log in</a>
                </li>
                <li>
                  <a href="../feed/index.html">Entries feed</a>
                </li>
                <li>
                  <a href="../comments/feed/index.html">Comments feed</a>
                </li>
                <li>
                  <a href="https://wordpress.org/">WordPress.org</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div id="main" class="site-main">
        <div id="post-118" class="post-page post-118 post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-interior tag-lifestyle">
          <div class="post-image">
            <img src="../wp-content/uploads/2021/05/blog-3.jpg" alt="Post Image">
          </div>
          <div class="post-wrapper">
            <div class="post-container has-thumbnail">
              <div class="row">
                <div class="post-heading col-md-8 offset-md-2">
                  <div class="categories">
                    <a class="category-name" href="../category/design/index.html">Backend</a>
                  </div>
                  <h1 class="post-title">GraphQL: understanding node interface.</h1>
                  <span class="post-date">Apr 16, 2020</span>
                </div>
                <div class="post-content col-md-10 offset-md-1">
					<h2>
						<a name="overview" href="#overview" class="anchor">
						</a>
						Overview
					  </h2>
					  
					  <p>To provide options for GraphQL clients to elegantly handle for caching and data refetching GraphQL servers need to expose object identifiers in a standardized way. In the query, the schema should provide a standard mechanism for asking for an object by ID. We refer to objects with identifiers as <em>nodes</em>.</p>
					  
					  <h2>
						<a name="reserved-types" href="#reserved-types" class="anchor">
						</a>
						Reserved Types
					  </h2>
					  
					  <p>To a GraphQL Server to be compatible, it must reserve certain types and type names to support the consistent object identification model. We should create the following types:</p>
					  
					  <ul>
					  <li>An interface named <em>Node</em>
					  </li>
					  <li>The <em>node field</em> on the root query type</li>
					  </ul>
					  
					  <h2>
						<a name="node-interface" href="#node-interface" class="anchor">
						</a>
						Node Interface
					  </h2>
					  
					  <p>The server must provide an interface called <em>Node</em>. That interface must include exactly one field, called <em>id</em> that returns a non-null <em>ID</em>. This <em>id</em> should be a globally unique identifier for the object, and with just this <em>id</em>, the server should be able to refetch the object.</p>
					  
					  <p>NOTE: If two objects appear in the query, both implementing the <em>Node</em> with identical <em>ids</em>, then the two objects must be equal.</p>
					  
					  <h2>
						<a name="node-root-field" href="#node-root-field" class="anchor">
						</a>
						Node root field
					  </h2>
					  
					  <p>The server must provide a root field named <em>node</em> that returns the <em>Node</em>  interface. This root field must take exactly one non-null <em>ID</em> argument called <em>id</em>.</p>
					  
					  <p>When the value returned by the server in the <em>Node</em>'s <em>id</em> field is passed as the <em>id</em> parameter to the <em>node</em> root field than this query should refetch the identical object that implements <em>Node</em>.</p>
					  
					  <p>Now that we have some insight we must answer the following questions:</p>
					  
					  <ul>
					  <li>How and when does Node ID gets created?</li>
					  <li>When Node ID is used?</li>
					  <li>How are the nodeDefinitions methods used?</li>
					  </ul>
					  
					  <p>These questions were asked in this post <a href="https://medium.com/code-oil/relay-graphql-de-mystifying-node-id-38757121b9c">Relay/GraphQL: De-mystifying Node Interface/ID</a>. The present post also answers theses questions besides showing more examples, a generic and scalable form of registering types, how to test your <em>nodeField</em> and a generalization of the <em>Node Interface</em> pattern.</p>
					  
					  <h2>
						<a name="how-and-when-the-node-ids-gets-created" href="#how-and-when-the-node-ids-gets-created" class="anchor">
						</a>
						How and when the Node IDs gets created?
					  </h2>
					  
					  <p>A <em>Node ID</em> is created for each GraphQL object declaring <em>GraphQLObjectType</em> for that object. The function <em>globalIdField</em> has the role of auto-generate the node ID when the GraphQL object is created.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">globalIdField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">IUser</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./UserModel</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">load</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./UserLoader</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="kd">const</span> <span class="nx">UserType</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLObjectType</span><span class="o">&lt;</span><span class="nx">IUser</span><span class="p">,</span> <span class="nx">GraphQLContext</span><span class="o">&gt;</span><span class="p">({</span>
						<span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User data</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">fields</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
						  <span class="c1">//  auto-generate node ID when the GraphQL object is created</span>
						  <span class="na">id</span><span class="p">:</span> <span class="nx">globalIdField</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">),</span>
						  <span class="p">...</span>
						<span class="p">}),</span>
						<span class="p">...</span>
					  <span class="p">});</span>
					  
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">UserConnection</span> <span class="o">=</span> <span class="nx">connectionDefinitions</span><span class="p">({</span>
						<span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">nodeType</span><span class="p">:</span> <span class="nx">GraphQLNonNull</span><span class="p">(</span><span class="nx">UserType</span><span class="p">),</span>
					  <span class="p">});</span>
					  
					  <span class="k">export</span> <span class="k">default</span> <span class="nx">registerTypeLoader</span><span class="p">(</span><span class="nx">UserType</span><span class="p">,</span> <span class="nx">load</span><span class="p">);</span>
					  
					  </code></pre></div>
					  
					  
					  
					  <p>Further, we will talk about <em>registerTypeLoader</em>.</p>
					  
					  <h2>
						<a name="when-the-node-id-is-used" href="#when-the-node-id-is-used" class="anchor">
						</a>
						When the Node ID is used?
					  </h2>
					  
					  <p>Well, we already know that <em>Node ID</em> is used for refetch. But when exactly does a refetch occurs?<br>
					  The First GraphQL request to fetch data is not a refetch and <em>Node IDs</em> have not been generated so far. The refetch occurs when on the client-side we already have GraphQL objects with <em>Node IDs</em> and, for instance: </p>
					  
					  <ul>
					  <li>we request more data for an existing GraphQL object, which can arise from another component relying on the same GraphQL object but requiring different pieces of data of that object</li>
					  <li>when the server-side object data has been changed </li>
					  <li>when to change the parameters used to fetch the original GraphQL object.</li>
					  </ul>
					  <h2>
						<a name="how-are-nodedefinitions-methods-used" href="#how-are-nodedefinitions-methods-used" class="anchor">
						</a>
						How are nodeDefinitions methods used?
					  </h2>
					  
					  <p>For GraphQL types that you want to refetch you request to auto-generate a <em>Node ID</em> for the object during creation, as seen above, and you also need to tell GraphQL how to map globally the <em>Node ID</em> provided during refetch into actual data objects and their GraphQL types. You do this defining the <em>interfaces</em> field on <em>GraphQLObjectType</em>.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// UserType.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">globalIdField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">IUser</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./UserModel</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">load</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./UserLoader</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">nodeInterface</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../interface/NodeDefinitions</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="kd">const</span> <span class="nx">UserType</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphQLObjectType</span><span class="o">&lt;</span><span class="nx">IUser</span><span class="p">,</span> <span class="nx">GraphQLContext</span><span class="o">&gt;</span><span class="p">({</span>
						<span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User data</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">fields</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
						  <span class="na">id</span><span class="p">:</span> <span class="nx">globalIdField</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">),</span>
						  <span class="p">...</span>
						<span class="p">}),</span>
						<span class="c1">// use nodeInterface for re-fetching this GraphQL type by node ID</span>
						<span class="na">interfaces</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nx">nodeInterface</span><span class="p">],</span>
					  <span class="p">});</span>
					  
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">UserConnection</span> <span class="o">=</span> <span class="nx">connectionDefinitions</span><span class="p">({</span>
						<span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">nodeType</span><span class="p">:</span> <span class="nx">GraphQLNonNull</span><span class="p">(</span><span class="nx">UserType</span><span class="p">),</span>
					  <span class="p">});</span>
					  
					  <span class="k">export</span> <span class="k">default</span> <span class="nx">registerTypeLoader</span><span class="p">(</span><span class="nx">UserType</span><span class="p">,</span> <span class="nx">load</span><span class="p">);</span>
					  </code></pre></div>
					  
					  
					  
					  <p>The <em>nodeDefinitions</em> has this format and export <em>nodeField</em>, <em>nodeFields</em> and <em>nodeInterface</em>.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// nodeDefinitions.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">nodeDefinitions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">idFetcher</span><span class="p">,</span> <span class="nx">typeResolver</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./nodeRegistry</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="k">export</span> <span class="kd">const</span> <span class="p">{</span> <span class="nx">nodeField</span><span class="p">,</span> <span class="nx">nodesField</span><span class="p">,</span> <span class="nx">nodeInterface</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">nodeDefinitions</span><span class="p">(</span>
						<span class="nx">idFetcher</span><span class="p">,</span>
						<span class="nx">typeResolver</span><span class="p">,</span>
					  <span class="p">);</span>
					  </code></pre></div>
					  
					  
					  
					  <p>Be aware that <em>nodeDefinitions</em> to tell GraphQL how performs the mapping the <em>Node ID</em> and has two methods:</p>
					  
					  <ul>
					  <li>the first receive the <em>globalId</em>, we map the <em>globalId</em> into its corresponding data object and with it can actually be able to read the GraphQL type and id of the object using <em>fromGlobalId</em> function. We will call it the <em>idFetcher</em>.</li>
					  <li>the second receive the result object and Relay uses that to map an object to its GraphQL data type. So if the object is an instance of User, it will return UserType and so on. We will call it the <em>typeResolver</em>.</li>
					  </ul>
					  
					  <p>See below how to implement the methods explained above:<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// nodeRegistry.ts - that not scale well</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">fromGlobalId</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="nx">User</span><span class="p">,</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">UserLoader</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../modules/user/UserLoader</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="nx">UserType</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../modules/user/UserType</span><span class="dl">'</span><span class="p">;</span>
					  <span class="c1">// many imports...</span>
					  
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">idFetcher</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">globalId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">context</span><span class="p">:</span> <span class="nx">GraphQLContext</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
						<span class="kd">const</span> <span class="p">{</span> <span class="nx">id</span><span class="p">,</span> <span class="kd">type</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">fromGlobalId</span><span class="p">(</span><span class="nx">globalId</span><span class="p">);</span>
					  
						  <span class="k">if</span> <span class="p">(</span><span class="kd">type</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">UserLoader</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
						  <span class="p">}</span>
						  <span class="c1">// many ifs...</span>
						  <span class="c1">// all the loads of your project</span>
						  <span class="p">...</span>
					  
						  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
					  <span class="p">};</span>
					  
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">typeResolver</span> <span class="o">=</span> <span class="nx">object</span> <span class="o">=&gt;</span> <span class="p">{</span>
						  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">User</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">UserType</span><span class="p">;</span>
						  <span class="p">}</span>
						  <span class="c1">// many ifs...</span>
						  <span class="c1">// all the types of your project</span>
						  <span class="p">...</span>
					  
						  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
					  <span class="p">}</span>
					  </code></pre></div>
					  
					  
					  
					  <p>Realize that this implementation can be improved.</p>
					  
					  <p>After that, expose the <em>node</em> and your other queries on <em>QueryType</em>:<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// QueryType.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLID</span><span class="p">,</span> <span class="nx">GraphQLString</span><span class="p">,</span> <span class="nx">GraphQLNonNull</span><span class="p">,</span> <span class="nx">GraphQLObjectType</span><span class="p">,</span> <span class="nx">GraphQLInputObjectType</span><span class="p">,</span> <span class="nx">GraphQLInterfaceType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">connectionArgs</span><span class="p">,</span> <span class="nx">fromGlobalId</span><span class="p">,</span> <span class="nx">globalIdField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">nodeField</span><span class="p">,</span> <span class="nx">nodesField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../interface/NodeDefinitions</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../types</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="k">import</span> <span class="nx">UserType</span><span class="p">,</span> <span class="p">{</span> <span class="nx">UserConnection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../modules/user/UserType</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">UserLoader</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../loader</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="k">export</span> <span class="k">default</span> <span class="k">new</span> <span class="nx">GraphQLObjectType</span><span class="o">&lt;</span><span class="kr">any</span><span class="p">,</span> <span class="nx">GraphQLContext</span><span class="o">&gt;</span><span class="p">({</span>
						<span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Query</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The root of all... queries</span><span class="dl">'</span><span class="p">,</span>
						<span class="na">fields</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
						  <span class="na">id</span><span class="p">:</span> <span class="nx">globalIdField</span><span class="p">(</span><span class="dl">'</span><span class="s1">Query</span><span class="dl">'</span><span class="p">),</span>
						  <span class="na">node</span><span class="p">:</span> <span class="nx">nodeField</span><span class="p">,</span>
						  <span class="na">nodes</span><span class="p">:</span> <span class="nx">nodesField</span><span class="p">,</span>
						  <span class="na">users</span><span class="p">:</span> <span class="p">{</span>
							<span class="na">type</span><span class="p">:</span> <span class="nx">GraphQLNonNull</span><span class="p">(</span><span class="nx">UserConnection</span><span class="p">.</span><span class="nx">connectionType</span><span class="p">),</span>
							<span class="na">args</span><span class="p">:</span> <span class="p">{</span>
							  <span class="p">...</span><span class="nx">connectionArgs</span><span class="p">,</span>
							  <span class="na">filters</span><span class="p">:</span> <span class="p">{</span>
								<span class="na">type</span><span class="p">:</span> <span class="k">new</span> <span class="nx">GraphQLInputObjectType</span><span class="p">({</span>
								  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">UserFilters</span><span class="dl">'</span><span class="p">,</span>
								  <span class="na">fields</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
									<span class="na">search</span><span class="p">:</span> <span class="p">{</span>
									  <span class="na">type</span><span class="p">:</span> <span class="nx">GraphQLString</span><span class="p">,</span>
									<span class="p">},</span>
								  <span class="p">})</span>
								<span class="p">}),</span>
							  <span class="p">}</span>
							<span class="p">},</span>
							<span class="na">resolve</span><span class="p">:</span> <span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="na">context</span><span class="p">:</span> <span class="nx">GraphQLContext</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">UserLoader</span><span class="p">.</span><span class="nx">loadAll</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">args</span><span class="p">),</span>
						  <span class="p">},</span>
						  <span class="p">...</span>
						<span class="p">}),</span>
					  <span class="p">});</span>
					  
					  </code></pre></div>
					  
					  
					  
					  <p>On playground take any <em>id</em> returned by <em>UserList</em> and pass it to <em>node</em> query, as this:<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="nx">query</span> <span class="nx">Node</span> <span class="p">{</span>
						  <span class="nx">node</span><span class="p">(</span><span class="nx">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">VXNlcjo1ZTgyNGM4YTUwZjcwMzdhMjhmZDdmZWU=</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
						  <span class="nx">id</span>
						  <span class="nx">__typename</span>
						<span class="p">}</span>
					  <span class="p">}</span>
					  </code></pre></div>
					  
					  
					  
					  <p>The result on <code>__typename</code> should be the <code>User</code> indicating the GraphQL type of the node.<br>
					  Well, you just realized how both <em>Node ID</em> and <em>nodeDefinitions</em> are used \o/.</p>
					  
					  <p>Now, we will go into a part about how you can improve its implementation.</p>
					  <h2>
						<a name="register-type-loader" href="#register-type-loader" class="anchor">
						</a>
						Register Type Loader
					  </h2>
					  
					  <p>To all GraphQL types that the server should be able to refetch you must register your <code>type</code> and <code>load</code> GraphQL. <br>
					  This may involve many imports, many ifs and fast growth of <code>nodeRegistry</code> as it was shown previously. We want to prevent this situation because it does scale well.<br>
					  In order to avoid the manual register on the <code>nodeRegistry</code> file, we use an object named <em>typesLoaders</em> that assigns a <code>type</code> and a <code>load</code> GraphQL through a function called <em>registerTypeLoader</em>. See again the snippet <code>UserType.ts</code> how simple it is to use it. So, the <code>nodeRegistry</code> just uses that object bringing it with the function <code>getTypesLoaders</code>. Check down its implementation:<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// registerTypeLoader.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLObjectType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">Load</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../types</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="kd">type</span> <span class="nx">TypeLoaders</span> <span class="o">=</span> <span class="p">{</span>
						<span class="p">[</span><span class="na">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="p">{</span>
						  <span class="na">type</span><span class="p">:</span> <span class="nx">GraphQLObjectType</span><span class="p">,</span>
						  <span class="na">load</span><span class="p">:</span> <span class="nx">Load</span><span class="p">,</span>
						<span class="p">};</span>
					  <span class="p">};</span>
					  
					  <span class="kd">const</span> <span class="nx">typesLoaders</span><span class="p">:</span> <span class="nx">TypeLoaders</span> <span class="o">=</span> <span class="p">{};</span>
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">getTypesLoaders</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">typesLoaders</span><span class="p">;</span>
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">registerTypeLoader</span> <span class="o">=</span> <span class="p">(</span><span class="kd">type</span><span class="p">:</span> <span class="nx">GraphQLObjectType</span><span class="p">,</span> <span class="nx">load</span><span class="p">:</span> <span class="nx">Load</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
						<span class="nx">typesLoaders</span><span class="p">[</span><span class="kd">type</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
						  <span class="kd">type</span><span class="p">,</span>
						  <span class="nx">load</span><span class="p">,</span>
						<span class="p">};</span>
					  
						<span class="k">return</span> <span class="kd">type</span><span class="p">;</span>
					  <span class="p">};</span>
					  </code></pre></div>
					  
					  
					  
					  <p>Use that function to type that you want that should be able to refetch, for instance: <code>UserType.ts</code>, <code>PostType.ts</code>, <code>TransacationType.ts</code> and so on.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// nodeRegistry.ts - clean implementation</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">fromGlobalId</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">getTypesLoaders</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./registerTypeLoader</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">GraphQLContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../types</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="kd">const</span> <span class="nx">typesLoaders</span> <span class="o">=</span> <span class="nx">getTypesLoaders</span><span class="p">();</span>
					  <span class="c1">// How to return an object given its globalId</span>
					  <span class="c1">// Is used to take the ID argument of the node field and use it to resolve an object</span>
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">idFetcher</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">globalId</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">context</span><span class="p">:</span> <span class="nx">GraphQLContext</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
						<span class="kd">const</span> <span class="p">{</span> <span class="kd">type</span><span class="p">,</span> <span class="nx">id</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">fromGlobalId</span><span class="p">(</span><span class="nx">globalId</span><span class="p">);</span>
						<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">typesLoaders</span><span class="p">[</span><span class="kd">type</span><span class="p">].</span><span class="nx">load</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
					  
						<span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
					  <span class="p">};</span>
					  
					  <span class="c1">// How to return a GraphQL type given an object</span>
					  <span class="c1">// Allows your GraphQL server to work out which GraphQL type of object was returned</span>
					  <span class="k">export</span> <span class="kd">const</span> <span class="nx">typeResolver</span> <span class="o">=</span> <span class="nx">object</span> <span class="o">=&gt;</span> <span class="nx">typesLoaders</span><span class="p">[</span><span class="nx">object</span><span class="p">.</span><span class="kd">constructor</span><span class="p">.</span><span class="nx">name</span><span class="p">].</span><span class="kd">type</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
					  </code></pre></div>
					  
					  
					  
					  <p>Much more structured and clean code, isn't it?</p>
					  
					  <h2>
						<a name="test-node-field" href="#test-node-field" class="anchor">
						</a>
						Test node field
					  </h2>
					  
					  <p>To test if your <em>node</em> query works you can try a test by an inline fragment or spread fragment. Here we will show both.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// NodeDefinitions.spec.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">toGlobalId</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">schema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../schema/schema</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should load User by inline fragment</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
						<span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createUser</span><span class="p">();</span>
					  
						<span class="kd">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="s2">`
						  query Node($id: ID!) {
							node(id: $id) {
							  id
							  ... on User {
								name
								username
								isActive
								__typename
							  }
							}
						  }
						`</span><span class="p">;</span>
					  
						<span class="kd">const</span> <span class="nx">rootValue</span> <span class="o">=</span> <span class="p">{};</span>
						<span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getContext</span><span class="p">();</span>
						<span class="kd">const</span> <span class="nx">variables</span> <span class="o">=</span> <span class="p">{</span>
						  <span class="na">id</span><span class="p">:</span> <span class="nx">toGlobalId</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">),</span>
						<span class="p">};</span>
					  
						<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphql</span><span class="p">(</span><span class="nx">schema</span><span class="p">,</span> <span class="nx">query</span><span class="p">,</span> <span class="nx">rootValue</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">variables</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">variables</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">username</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">isActive</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">isActive</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">__typename</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">);</span>
					  <span class="p">});</span>
					  </code></pre></div>
					  
					  
					  
					  <p>Like we already registered the GraphQL type <code>User</code> and define the <em>nodeField</em> on <code>Query</code> we can test if the <em>node</em> brings the data correctly. First we create a user, after we define the query, a root value which can be an empty object, a context which must be similar to the passed on the your server, the variables that your query needs in that case the <em>id</em>. To execute the query we put that informations into <code>graphql</code> and finally we can to compare the returned data to verify if it is correct or not.<br>
					  </p>
					  
					  <div class="highlight"><pre class="highlight typescript"><code><span class="c1">// NodeDefinitions.spec.ts</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">toGlobalId</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">graphql-relay</span><span class="dl">'</span><span class="p">;</span>
					  <span class="k">import</span> <span class="p">{</span> <span class="nx">schema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../schema/schema</span><span class="dl">'</span><span class="p">;</span>
					  
					  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should load User by spread fragment</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
						<span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">createUser</span><span class="p">();</span>
					  
						<span class="kd">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="s2">`
						  query Node($id: ID!) {
							node(id: $id) {
							  id
							  ...userFields
							  __typename
							}
						  }
					  
						  fragment userFields on User {
							name
							username
							isActive
						  }
						`</span><span class="p">;</span>
					  
						<span class="kd">const</span> <span class="nx">rootValue</span> <span class="o">=</span> <span class="p">{};</span>
						<span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getContext</span><span class="p">();</span>
						<span class="kd">const</span> <span class="nx">variables</span> <span class="o">=</span> <span class="p">{</span>
						  <span class="na">id</span><span class="p">:</span> <span class="nx">toGlobalId</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">_id</span><span class="p">),</span>
						<span class="p">};</span>
					  
						<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">graphql</span><span class="p">(</span><span class="nx">schema</span><span class="p">,</span> <span class="nx">query</span><span class="p">,</span> <span class="nx">rootValue</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">variables</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">variables</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">username</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">isActive</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">isActive</span><span class="p">);</span>
						<span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="o">!</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">__typename</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">'</span><span class="s1">User</span><span class="dl">'</span><span class="p">);</span>
					  <span class="p">});</span>
					  </code></pre></div>
					  
					  
					  
					  <p>This second test is just to check that our <em>node</em> also works with spread fragment and has the same behavior as the first. However, the test fulfills its role of checking if it works for both types of query. </p>
					  
					  <h2>
						<a name="next" href="#next" class="anchor">
						</a>
						Next
					  </h2>
					  
					  <p>Recently the relay team made a commit named <a href="https://github.com/facebook/relay/commit/6ed719438829d02912c862407bbf84a6374f14f3">@refetchable support for @fetchable types</a> in which they add the <code>@fetchable</code> directive. It has the role to define the schema to specify that a GraphQL type is refetchable and what field should be used to refetch it. Therefore, this is a generalization of the pattern explained in this post. Instead <em>node</em> on <code>QueryType</code> we must define <em>foo root field</em> could implement refetchable on top of our custom <em>Foo Node Interface</em>. It's basically the <em>node</em> interface with different field names.</p>
					  
					  <h2>
						<a name="conclusion" href="#conclusion" class="anchor">
						</a>
						Conclusion
					  </h2>
					  
					  <ul>
					  <li>Declare <code>globalIdField</code> on your GraphQL type to make GraphQL auto-generate a unique global <em>Node ID</em> for your GraphQL object during creation and ensure that it must be refetched.</li>
					  <li>Implement <em>nodeDefinitions</em> methods to map <em>Node ID</em> back to the corresponding server-side object, which you then can use to return other or updated attributes when a refetch provides the <em>Node ID</em>.</li>
					  <li>Use <em>nodeInterface</em> on your GraphQL type to instruct GraphQL to use the <em>nodeDefinitions</em> implementation to resolve between <em>Node ID</em> and actual server-side objects.</li>
					  <li>Use the <em>registerTypeLoader</em> to avoid the manual register on the <code>nodeRegistry</code> file and make the code more organized and scalable.</li>
					  <li>Use tests to avoid unwanted behaviors.</li>
					  <li>There was a generalization in the pattern. </li>
					  </ul>
					  
					  <h2>
						<a name="resources" href="#resources" class="anchor">
						</a>
						Resources
					  </h2>
					  
					  <ul>
					  <li>
					  <a href="https://relay.dev/graphql/objectidentification.htm">GraphQL Global Object Identification Specification</a>.</li>
					  <li>
					  <a href="https://medium.com/code-oil/relay-graphql-de-mystifying-node-id-38757121b9c">Relay/GraphQL: De-mystifying Node Interface/ID</a>.</li>
					  <li>
					  <a href="https://stackoverflow.com/questions/42576581/what-is-nodeinterface-nodefield-and-nodedefinitions-in-relay">What is nodeInterface, nodeField and nodeDefinitions in Relay?</a>.</li>
					  <li>
					  <a href="https://github.com/facebook/relay/commits/master">Relay Commits</a>.</li>
					  </ul>
					  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="ajax-portfolio-popup">
      <span class="ajax-loader"></span>
      <div class="navigation-wrap">
        <span class="popup-close">
          <i class="fas fa-times-circle"></i>
        </span>
      </div>
      <div class="content-wrap">
        <div class="container">
          <div class="row">
            <div class="col-md-10 offset-md-1">
              <div class="popup-heading"></div>
              <div class="popup-content"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type='text/javascript' src='../wp-includes/js/dist/vendor/regenerator-runtime.minb36a.js?ver=0.13.7' id='regenerator-runtime-js'></script>
    <script type='text/javascript' src='../wp-includes/js/dist/vendor/wp-polyfill.min2c7c.js?ver=3.15.0' id='wp-polyfill-js'></script>
    <script type='text/javascript' id='contact-form-7-js-extra'>
      var wpcf7 = {
        "api": {
          "root": "https:\/\/cosmos-themes.online\/themes\/watson\/wp-json\/",
          "namespace": "contact-form-7\/v1"
        }
      };
    </script>
    <script defer src="../wp-content/cache/autoptimize/js/autoptimize_61962f43b02c29872a14607372d50c08.js"></script>
  </body>
  <!-- Mirrored from cosmos-themes.online/themes/watson/my-current-workspace/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 23 Nov 2021 07:42:28 GMT -->
</html>